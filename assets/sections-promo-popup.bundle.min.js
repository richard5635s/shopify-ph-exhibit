import{a as e}from"./shared-import-js.cookie.bundle.min.js";document.addEventListener("alpine:init",(()=>{Alpine.data("ThemeSection_PromoPopup",(o=>({delay:o.delay,frequency:o.frequency,enabled:o.enabled,sectionId:o.sectionId,cookie:e.get("promoPopup"),mounted(){if("/challenge"===window.location.pathname)return;initTeleport(this.$root),Alpine.store("modals").register("promoPopup","promo"),document.body.addEventListener("promo-is-closed",(o=>{e.set("promoPopup","opened",{path:"/",expires:this.frequency})}));const o=this.$refs.teleported.content.querySelector("template").content,t=Boolean(o.querySelector("[data-errors]")),n=Boolean(o.querySelector("[data-success-message]"));console.log(t),console.log(n),(n||t)&&(this.open(),this.clearSuccessParams(),e.set("promoPopup","opened",{path:"/",expires:200})),Shopify.designMode?(window.theme.designMode.selected===this.sectionId&&(!0===this.enabled?this.open():Alpine.store("modals").close("promoPopup")),document.addEventListener("shopify:section:select",(e=>{e.target.contains(this.$root)&&this.enabled&&this.open()})),document.addEventListener("shopify:section:deselect",(e=>{e.target.contains(this.$root)&&this.$store.modals.close("promoPopup")}))):"opened"!==this.cookie&&setTimeout((()=>{this.open();const e=o=>{"ESCAPE"===o.code.toUpperCase()&&(this.$store.modals.close("promoPopup"),document.body.removeEventListener("keydown",e))};document.body.addEventListener("keydown",e)}),1e3*this.delay)},open(){this.$store.modals.open("promoPopup"),this.$focus.first()},clearSuccessParams(){console.log(window.location),console.log(window.location.search);const e=new URLSearchParams(window.location.search);let o;e.has("customer_posted")&&e.delete("customer_posted"),o=e.toString().length>0?`${window.location.pathname}?${e.toString()}`:window.location.pathname,console.log(window.location.pathname+e.toString()),history.replaceState("",document.title,o)}})))}));
